# Table of Content
- [Execise](#exercise)
- [Frequently Used Commands](#frequently-used-commands)
- [Host Discovery](#host-discovery)
    - [Ping Sweep](#ping-sweep)
    - [TCP SYN Ping Scan](#tcp-syn-ping-scan)
    - [ICMP Echo Ping Scan](#icmp-echo-ping-scan)
    - [ICMP Address Mask Scan](#icmp-address-mask-scan)
    - [ICMP Echo Timestamp Scan](#icmp-echo-timestamp-scan)
    - [UDP Ping Scan](#udp-ping-scan)
    - [IP Ping Scan](#ip-ping-scan)
    - [ARP Ping Scan](#arp-ping-scan)
    - [SCTP INIT Ping Scan](#sctp-init-ping-scan)
    - [Traceroute](#traceroute)
- [Reference](#reference)
# Exercise
- [Nmap argument practice](https://pattharadanai-sanitjairak.github.io/Exercise/Nmap/nmap.html) - fill answer

[Back to Table of Content](#table-of-content)
# Frequently Used Commands
[Back to Table of Content](#table-of-content)

# Host Discovery
[Back to Table of Content](#table-of-content)
## Ping Sweep
- Discovery all hosts in the network with `Ping scan`
- With this options, port scan is `disabled`
- `sP` is same as `-sn`
- `nmap -sP <network_address>/<network_mask>`
- `nmap -sn <network_address>/><network_mask>`

Example
```bash
nmap -sP 192.168.1.0/24
nmap -sn 192.168.1.0/24
```
- with `--packet-trace`, it will produce more debug information.

Example
```bash
nmap -sP 192.168.1.1 --packet-trace
```
- with `--disable-arp-ping`, it will not use `arp discovery`
- `--disable-arp-ping` is same as `--send-ip`
- It will relies on 
    - ICMP echo (type 8)
    - ICMP timestamp (type 13)
    - TCP SYN port 443
    - TCP ACK port 80

Example
```bash
nmap -sP 192.168.1.1 --disable-arp-ping --packet-trace
nmap -sn 192.168.1.1 --send-ip --packet-trace
```
[Back to Table of Content](#table-of-content)
## TCP SYN Ping Scan
- use `-PS` argument
- Send `empty SYN TCP` to `port 80`
- This may `avoid creating log`

Example
```bash
nmap -sn -PS 192.168.1.1 --packet-trace
```

## TCP ACK Ping Scan
- use `-PA` argument
- Send `empty ACK TCP` to `port 80`
- This may `avoid creating log`

Example
```bash
nmap -sn -PA 192.168.1.1 --packet-trace
```
[Back to Table of Content](#table-of-content)
## ICMP Echo Ping Scan
- Just normal ping
- Usually be blocked
- use `-PE` argument

Example
```bash
nmap -sn -PE 192.168.1.1 --disable-arp-ping
```
[Back to Table of Content](#table-of-content)
## ICMP Address Mask Scan
- Older method of `ICMP ECHO`
- May give information about `system` and `subnet mask`
- use `-PM` argument
[Back to Table of Content](#table-of-content)
Example
```bash
nmap =sn -PM 192.168.1.1 --disable-arp-ping
```
[Back to Table of Content](#table-of-content)
## ICMP Echo Timestamp Scan
- Usually used in synchronization of time
- Usually be blocked
- use `-PP` argument
[Back to Table of Content](#table-of-content)
Example
```bash
nmap -sn -PP 192.168.1.1 --disable-arp-ping
```
[Back to Table of Content](#table-of-content)
## UDP Ping Scan
- send `UDP` to `port 40125`
- use `-PU` argument

Example
```bash
nmap -sn -PU 192.168.1.1 --disable-arp-ping
```
[Back to Table of Content](#table-of-content)
## IP Ping Scan
- send various packets based on `IP protocols`
    - UDP
    - TCP
    - ICMP
    - IGMP
- use `-PO` argument

Example
```bash
nmap -sn -PO 192.168.1.1 --disable-arp-ping
```
[Back to Table of Content](#table-of-content)
## ARP Ping Scan
- `ARP` usually invisible to the firewall
- use `-PR` argument

Example
```bash
nmap -sn -PR 192.168.1.1
```
[Back to Table of Content](#table-of-content)
## SCTP INIT Ping Scan
- Send `SCTP` packet containing `INIT` chunk to `port 80`
- use `-PY` argument

Example
```bash
nmap -sn -PY 192.168.1.1 --disable-arp-ping
```
[Back to Table of Content](#table-of-content)
## Traceroute
- just a traceroute
- use `--traceroute` argument

Example
```bash
nmap -sn --traceroute 1.1.1.1
```
[Back to Table of Content](#table-of-content)

# Reference
- [Aryaa Mathur](https://www.linkedin.com/in/aryaacybersec/) - [Nmap Host Discovery](https://www.linkedin.com/posts/aryaacybersec_nmap-host-discovery-activity-7198525468420026370-8mzJ?utm_source=share&utm_medium=member_desktop) - 21 May 2024

[Back to Table of Content](#table-of-content)