# Chapter 4: Social Engineering and Password Attacks
<< [Back to the main page](README.md) 
<br>
<br>
< [Go to Chapter 3: Malicious Code](Chapter3.md)
<br>
[Go to Chapter 5: Security Assessment and Testing](Chapter5.md) >  
----------------------------------------------

# Table of Content
- [Exercise](#exercise)
- [Social Engineering](#social-engineering)
    - [Common Social Engineering Principles](#common-social-engineering-principles)
        - [Authority](#authority)
        - [Intimidation](#intimidation)
        - [Consensus-based](#consensus-based)
        - [Scarcity](#scarcity)
        - [Familiarity-based](#familiarity-based)
        - [Trust](#trust)
        - [Urgency](#urgency)

- [Password Attacks](#password-attacks)
    - [Brute Force](#brute-force)
    - [Password Spraying](#password-spraying)
    - [Dictionary Attack](#dictionary-attack)
    - [Rainbow Table Attack](#rainbow-table-attack)
    - [Pharming](#pharming)
    - [Credential Stuffing](#credential-stuffing)
    - [Keylogging](#keylogging)
    - [Man-in-the-Middle (MitM)](#main-in-the-middle-mitm)
    - [Pass the hash](#pass-the-hash)
    - [Shoulder Surfing](#shoulder-surfing)

- [Password Cracking Tools](#password-cracking-tools)
    - [Hashcat](#hashcat)
    - [John the Ripper](#john-the-ripper)
    - [Hydra](#hydra)

- [Password Policy](#password-policy)
    - [Multi-Factor Authentication](#multi-factor-authentication)
        - [Somethings you know](#somethings-you-know)
        - [Somethings you are](#somethings-you-are)
        - [Somethings you have](#somethings-you-have)

# Exercise
[Back to Table of Content](#table-of-content)

# Social Engineering
- Human HAcking
- Focus on human side of information security

[Back to Table of Content](#table-of-content)

## Common Social Engineering Principles
- Key strategies to success tricking people

[Back to Table of Content](#table-of-content)

### Authority
- Hackers trick the user that they are in chrage or knowledgable
- Pretend to be `manager`
- Pretend to be `CEO`
- Pretend to be `Specialist`
- Pretend to be `Technician` so that customer can consult
- Pretend to be `Officer`
- Pretend to be `Government Related`
- Pretend to be `Mail Officer` so that customer can consult about mail or packaging

[Back to Table of Content](#table-of-content)

### Intimidation
- Threathen the users
- Exploit the `fear` of the users
- Bullying the users into taking a desired action
- Threathen to blackmail
- Threathen to confiscation
- Threathen to be charge in lawsuit
- Threathen to be danger in life
- Threathen to be danger in life of family
- Threathen to expose the sensitive data
- [Computer Hoax](Chapter3.md/#computer-hoax)

[Back to Table of Content](#table-of-content)

### Consensus-based
- Use the `fact` that people tend to do.
- Can be called `social proof`
- Hacker persuade user to click the link to purchase `product A` which is commonly purchased by many people. (In fact the link after clicking is malicious)
- Many people use it, why don't you use it as well?
- It is very normal for people to do or buy this
- It is common, everybody has already done it before.
- Show the number of like and comments from a specific social media theards
- Show the advertistment

[Back to Table of Content](#table-of-content)

### Scarcity
- Trick the user that this resources is limited.
- Exclusive item, need to purchase before it run out
- Make somethings look more desirable because it may be the last one available.
- Hurry up! this promotion is limited offer!

[Back to Table of Content](#table-of-content)

### Familiarity-based
- Show that there is the people you know have done this.
- rely on user's liking the individual or even the organization the individual is claiming to represent.
- Many people from your company is using it. Why don't you also use it?
- This superstar use it, why don't you also use it?
- Oh, you are also the member of XXXX, many people also use it, why don't you also use it?

[Back to Table of Content](#table-of-content)

### Trust
- Rely on trust or connection
- can be call `baiting`
- Gain trust and connection from user and then trick the user

[Back to Table of Content](#table-of-content)

### Urgency
- Creating feeling that the action must be taken quickly
- Quick! the time is running out, why dont' you use it!
- This promotion will be expired soon, use it!
- This is emergency, can you hurry give your credentials to protect this accident?
- This is CEO, please give your password quickly, customer is in hurry!

[Back to Table of Content](#table-of-content)

## Common Social Engineering Techniques
[Back to Table of Content](#table-of-content)

### Phishing
- Broad terms used to describe the fradulent acquisition of information
- Primarily focus on `credentials`, `credit card numbers`, `sensitive information`
- [Threat Vector](Chapter2.md/#threat-vector-and-attack-surface) is various such as SMS, Email, or voice
- Example of phishing type
    - Spearh Phishing : phishing that the target is specific person or organization
    - Angler Phishing : phishing on social media platforms
    - Whaling : phishing that the target have high value such as financial department, financial officer, chief of financial
    - Vishing : phishing using voice (voice + phishing)
    - Smishing : phishing using SMS (SMS + phishing)

[Back to Table of Content](#table-of-content)

### Misinformation
- `Influence Campaign`
    - Create fake social media accounts
    - Cheat the number of link
    - Cheat the number of posts
    - Mule Accounts
    - Information Operation (IO)
    - Hire people to fake as the product's user
    
- Fake News
- Disinformation
- Fake Advertistment
- Over Exaggerated Advertisment

[Back to Table of Content](#table-of-content)

### Pretexting
- Made-up scenario
- support `impersonation`
- Hacker may make up the story that they familiar with this topics more than 5 years
- I am the specialist in this field for 10 years (which is not)
- My company is broken, I want your help (In fact, there is no company, or company is not broken)

[Back to Table of Content](#table-of-content)

### Impersonation
- `Pretend to be someone else`
- Identity Fraud
- Identity Theft
- Can be part of penetration tester to test employee awareness
- Can be part of phishing campaign
- Can be part of awareness training

[Back to Table of Content](#table-of-content)

### Brand Impersonation
- Instead of pretend to be someone else
- Pretende to be legitimate brand
- Build fake brand or company to trick user
- Build scam email

[Back to Table of Content](#table-of-content)

### Business Email Compromises
- Send email for phishing
- The email domain is business email
    - Send from insider
    - Compromised by outsider
    - Send spoofed emails
    - User malware or other tools

- hacker@companyA.com (companyA.com is legitimate but the email is compromised by hacker)
- Consultant@apple.com (In fact, there is no username Consultant in Apple Company)
- Use common fake but similar domain techniques
    - CEO@appie.com (use i instead of l to indicate that this email is from apple company)
    - CEO@apple.in.th (append more domains)

- Play with `authority` and `trust` - The domain of email display the organization or company identity.

[Back to Table of Content](#table-of-content)

### Typosquatting
- Use misspelled links to attack
- People mistype URLs
- github.com but mistakenly type `guthib.com`
- amazon.com but hacker hosted `amason.com`

[Back to Table of Content](#table-of-content)

### Watering Hole Attacks
- Attack the source that frequently visited by the user
- Many of `Company A` employees always visit `Coffee shop X`
    - Attack the coffee shop X
    - Phishing as Coffee shop X
    - Attack the website of coffee shop X to gain credentials

- Compromise the website that frequently visited by the user or organizations
    - After compromise, `credential harvesting` will be easier
    - Phishing will be easier
    - Attacking will be easier

[Back to Table of Content](#table-of-content)

### Tailgating
- There has security lock on the door
- Follow the authorized people through the door
- Hacker may walk behind and follow the employee who have key cards
    - After employee use keycard and door is openned
    - Hacker immediately follow the back of employee before the door is locked

- `Mantrap`
    - A temporary rooms that hold 2 security doors
    - Hacker may be trapped in between 2 security doors
    - Open the doors from inside may require key card - hacker cannot escape

- `Turnstile`
    - The door that use spinning mechanism
    - Allow one people to access the building per use
    - Found in many department stores

[Back to Table of Content](#table-of-content)

### Elicitation
- Ask specific or well-crafted questions to get information
- Indirectly ask sometimes but get the information
- Extracting sensitive information from casual conversion withotu raising suspicion

[Back to Table of Content](#table-of-content)

# Password Attacks
- Acquire password
- Bypass password authentication
- Cracking password

[Back to Table of Content](#table-of-content)

## Brute Force
- Try all possible password from the rules
- Password policy is 4 digits number - try all number from 0000 - 9999
- Password is 8 characters - try all possible combinations (more than billion combinations)
- Password is in this list - try all password stored in the given list

[Back to Table of Content](#table-of-content)

## Password Spraying
- Use the same set of passwords with different accounts or usernames
- Avoid account lock
- Try password 1234 with different 1,000 accounts
- Try many password in a single accounts, the system may lock the log in functions

[Back to Table of Content](#table-of-content)

## Dictionary Attack
- Brute force the password that stored in the specified list or `dictionary`
- Create a list of password
- List of common passwords
    - Rockyou.txt - The commons list of password used by penetration tester
    - [Seclists](https://github.com/danielmiessler/SecLists/tree/master/Passwords/Common-Credentials) also provide the list of common passwords

- List can be crafted by user preference
    - name, lastname
    - phone number
    - favorite things

[Back to Table of Content](#table-of-content)

## Rainbow Table Attack
- A precomputed tables that contain pairs of `plaintext password` and `hash value`
- Many of system stored password in hash format
- Hacker may generate a table of hash by their own condition
- If the password is too common, their plaintext may appear in the rainbow table database
- Somtimes known as `Password Cracking` - convert hash back to the password plaintext by brute forcing the list in the `rainbow table`

[Back to Table of Content](#table-of-content)

## Pharming
- Modify the DNS of the company/user (DNS Poisoning)
- When use access a specific websites, it route to a fake website
- The fake website can gather the password or credentials (credential harvesting)
- The fake website can harm the user who accidentally redirect to by the DNS poisoning

[Back to Table of Content](#table-of-content)

## Credential Stuffing
- Use credential from data breaching source against the system
- HaveIBeenPwned - used to check if the email is compromised (Password may also be leaked as well)
- Dehashed - check the leaked password
- Dark Web - purchase the leakage database of password from specific list or company
- leakbase.io - hacker forum that sold leakage database
- Example of company database that is already leaked
    - Shopback
    - Zyngar
    - Aptoide
    - Sony
    - Mojang

[Back to Table of Content](#table-of-content)

## Keylogging
- Spy or monitor the key or mouse pressing by the user
- Type of [spyware](chapter3.md/#keyloggers)
- Can get the user's password by monitoring keyboard typing activity

[Back to Table of Content](#table-of-content)

## Main-in-the-Middle (MITM)
- Intercept the request between users and servers
- If the communication ([data in transit](chapter1.md/#data-in-transit)) is not encryption, attacker can intercept and see the password
- eavedropping the password
- sniffing the traffic and see the password
- Sometimes known as `on-path attack`

[Back to Table of Content](#table-of-content)

## Pass the Hash
- To prevent password being sent in the communication
- System may choose to send [hash](chapter1.md/#hashing) of password instead
- Attacker capture the `hash` and directly submit to the system without `cracking for the password` or utilize `rainbow table attack` to get the password.
- System may accept hash as log in
- Should implement `OTP` or `Nonce` to prevent pass the hash attack
- `Responder Tools` - popular tools used to perform pass the hash attack

[Back to Table of Content](#table-of-content)

## Shoulder Surfing
- Secretly look from behind the user while user typing the password
- User typing password on laptop - sometimes stay behind and observe the password or keyboard typing
- Hacker stay behind and try to observe ATM pin
- They are `specific screen` that prevent people to observe from behind
    - Privacy Screens
    - Privacy Filters
    - Anti-Glare Screens

[Back to Table of Content](#table-of-content)

# Password Cracking Tools

[Back to Table of Content](#table-of-content)

## Hashcat
- Cracking password using rainbow table attack
- IT GPU-based utilization
- Support various of operation and algorithms
- Faster than `john the ripper` if GPU is enabled

[Back to Table of Content](#table-of-content)

## John the Ripper
- Cracking password using rainbow table attack
- It CPU-based utilization

[Back to Table of Content](#table-of-content)

## Hydra
- Tools to perform automated dictionary attack, password spraying, password brute forcing.
- It can attack various protocol such as SSH, FTP, HTTP, Website, and more

[Back to Table of Content](#table-of-content)

# Password Policy
- Defines how to construct and manage password
- Hacker can create custom `dictionary` according to `the password policy` for `dictionary attack`
- Password Length : length of password
    - Minimum Password Lenth
    - Maximum Password Lenth

- Password Complexity : mixing of alphabets, digits, and special characters
- Password History: store the previous password
    - May use to enforce disable `password reuse`
    - User cannot use the same previous password
    - Password reuse may be same password but different platforms

- Password Expiration : will force user to change password when the expiration time is reached
    - Known as `Password Age`
    - Password Expiration Notification

- Account Lockout Policy : how may of fail login attempts will temporarily blocked the log in functions
    - Known as `Account Lockout Threshold`
    - Account Lockout Duration : time until the account is unlocked again
- Default password: initial password provided by system to the user for the first time use
    - User may change later

- `PIN`
    - Personal Identification Number
    - Password that used number only
    - Very short and easy to remember

- `Passpharse`
    - Instead of random text or words
    - You can use your favorite sentence or song lyrics for authentication
    - `123123` = PIN
    - `i3jiojde` = Password
    - `NeverGonnaGiveYouUPNeverGonnaLetYouDown` = Passpharse
    - Passpharse can apply password policy or complexity

[Back to Table of Content](#table-of-content)

## Multi-Factor Authentication
- If we combine 2 factors for login it is called `two-factor authentication`
- If we combine more than 2 factors it is called `multi-factor authentication`

[Back to Table of Content](#table-of-content)

### Somethings you know
- Things only you is known
- password
- phone number
- specific answer to a specific question

[Back to Table of Content](#table-of-content)

### Somethings you are
- Things that can be only found in you
- Eye retina
- Your voice
- Your face
- Your fingerprint
- Your gesture

[Back to Table of Content](#table-of-content)

### Somethings you have
- Things that only you can have
- Your mobile phone (to recieve the OTP)
- Your key cards
- Your keys
- Your authenticator

[Back to Table of Content](#table-of-content)

### Other factors
- Location of log in
- Browser used to log in
- Environment of the log in
- Time of the log in 

[Back to Table of Content](#table-of-content)
----------------------------------------------------------------
< [Go to Chapter 3: Malicious Code](Chapter3.md)
<br>
[Go to Chapter 5: Security Assessment and Testing](Chapter5.md) > 